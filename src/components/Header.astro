---
import ThemeCustomizer from './ThemeCustomizer';
import ThemeToggle from './ThemeToggle.astro';

const currentPath = Astro.url.pathname;

const navLinks = [
  { name: 'home', href: '/' },
  { name: 'projects', href: '/projects' },
  { name: 'posts', href: '/posts' },
  { name: 'tags', href: '/tags' },
  { name: 'about', href: '/about' },
];
---

<header id="header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-200 border-b border-transparent">
  <div class="max-w-6xl mx-auto px-6 md:px-12 py-4 flex justify-end items-center gap-4">
    <nav class="flex gap-6">
      {navLinks.map(link => {
        const isActive = link.href === '/'
          ? currentPath === '/'
          : currentPath.startsWith(link.href);

        return (
          <a
            href={link.href}
            class={`group relative font-mono text-sm text-text-secondary hover:text-accent transition-all duration-200 after:absolute after:left-0 after:-bottom-1 after:h-[2px] after:w-full after:origin-left after:scale-x-0 after:bg-accent after:transition-transform after:duration-200 ${
              isActive ? 'text-accent after:scale-x-100' : 'group-hover:after:scale-x-100'
            }`}
          >
            {link.name}
          </a>
        );
      })}
    </nav>
    <div class="flex gap-3 items-center">
      <ThemeToggle />
      <ThemeCustomizer client:load />
    </div>
  </div>
</header>

<style>
  #header.scrolled {
    background-color: color-mix(in srgb, var(--bg) 95%, transparent);
    backdrop-filter: blur(8px);
    border-bottom-color: var(--border);
  }
</style>

<script>
  const header = document.getElementById('header');

  window.addEventListener('scroll', () => {
    if (window.scrollY > 50) {
      header?.classList.add('scrolled');
    } else {
      header?.classList.remove('scrolled');
    }
  });
</script>
